---
title: Writeup Flare-on9 2022 
author: vietzettt
date:  2022-10-1 
layout: post
published: true
cover: /src/2022/Flare-on9/00_img_pages/FlareOn_Logo.svg
---

---

##### **Nguá»“n á»Ÿ Ä‘Ã¢y nhÃ¡ cÃ¡c báº¡n:** [ğŸ’€**ğŸ‘†ğŸ‘†ğŸ‘†**ğŸ’€](https://www.mandiant.com/resources/blog/flareon9-challenge-solutions)

Xin chÃ o cÃ¡c báº¡n Ä‘áº¿n vá»›i writeupp láº§n nÃ y. Láº§n Ä‘áº§u gÃ  con vÃ o Ä‘áº£o cá»§a cÃ¡c lÃ£nh lÃ ng sáº½ nhÆ° tháº¿ nÃ o nhá»‰? Há»‘t hoáº£ng tháº­t sá»± hÃ­ hÃ­...
Sau quÃ¡ trÃ¬nh nghiÃªn cá»©u vÃ  tÃ¬m hiá»ƒu tÃ´i sáº½ viáº¿t hoÃ n thÃ nh táº¥t cá»§a cÃ¡c chall cá»§a mÃ¹a giáº£i nÄƒm nay cho mn Ä‘Æ°á»£c tham kháº£o nhÃ©. ([Link](https://nextheia.com/tags/flare-on-9-write-up/))

Ok báº¯t Ä‘áº§u thÃ´i... gÃ©t gÃ´...

### 1: Flaredle (Solved)

Description:

```text
Welcome to Flare-On 9!

You probably won't win. Maybe you're like us and spent the year playing Wordle. We made our own version that is too hard to beat without cheating.

Play it live at: http://flare-on.com/flaredle/
```

![title](/src/2022/Flare-on9/01_Flaredle/00_titile.png)
ChÃºng ta Ä‘Æ°á»£c nháº­n 4 file. Äáº§u tiÃªn sáº½ má»Ÿ file Ä‘uÃ´i `.html` Ä‘á»ƒ xem ná»™i dung hiá»‡n thá»‹ lÃ  gÃ¬? Ta tháº¥y nÃ³ sá»­ dá»¥ng `js` Ä‘Æ°á»£c cung cáº¥p sáºµn. Tháº¿ nÃªn lÃ  tÃ´i má»Ÿ file `js` check xem há» viáº¿t gÃ¬ vÃ  dáº¥u gÃ¬ á»Ÿ Ä‘Ã³.
Xem qua ta tháº¥y cÃ³ hÃ m `if` kiá»ƒm tra chuá»—i tá»« ngÆ°á»i dÃ¹ng vÃ  chuá»—i flag náº±m trong file `script.js`:
![function check](/src/2022/Flare-on9/01_Flaredle/01_function_check.png)
Ta tÃ¬m kiáº¿m `rightGuessString` xem nÃ³ lÃ  gÃ¬??
![var right](/src/2022/Flare-on9/01_Flaredle/02_var_rightguessstring.png)
Ok nháº­n tháº¥y biáº¿n nÃ y Ä‘Æ°á»£c láº¥y tá»« thá»© `57` trong file `words.js`. Tá»« Ä‘Ã³ ta nháº­n Ä‘Æ°á»£c: `flareonisallaboutcats`. Kiá»ƒm tra láº¡i trÃªn web thá»a mÃ£n.
![check result](/src/2022/Flare-on9/01_Flaredle/03_check_result.png)

### 2: PixelPocker (Solved)

Description

```text
I said you wouldn't win that last one. I lied. The last challenge was basically a captcha. Now the real work begins. Shall we play another game?
```

CÃ´ng cá»¥ Ä‘Æ°á»£c sá»­ dá»¥ng:

- CFF Explorer
- IDA Pro
- Python
  - PIL: pip install pillow (1 fork tá»« thÆ° viá»‡n PIL cá»§a python Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ xá»­ lÃ½ hÃ¬nh áº£nh)

Ná»™i dung cá»§a `readme.txt`

```text
Welcome to PixelPoker ^_^, the pixel game that's sweeping the nation!

Your goal is simple: find the correct pixel and click it

Good luck!
```

Äáº§u tiÃªn ta má»Ÿ báº±ng `CFF Explorer` quan sÃ¡t metadata cá»§a file exe. VÃ  ta cÃ³ chÃº Ã½ vá» resourse lÃ  dáº¡ng Bitmaps (áº£nh) gá»“m 2 bá»©c áº£nh vá»›i tÃªn 129 vÃ  133.
![check metadata](/src/2022/Flare-on9/02_PixelPocker/00_check_cff.png)
ChÆ°Æ¡ng trÃ¬nh hÆ°á»›ng Ä‘áº¿n viá»‡c cáº§n pháº£i lÆ°áº¡ chá»n 1 Ä‘iá»ƒm áº£nh vá»›i tá»a Ä‘á»™ hiá»‡n thá»‹ trÃªn cá»­a sá»• vÃ  cÃ³ Ä‘á»‘i ta 10 láº§n thá»­.
![open file](/src/2022/Flare-on9/02_PixelPocker/00_open_file.png)

vÃ  tÃ´i thá»­ xem ra káº¿t quáº£ lÃ  gÃ¬:
![test](/src/2022/Flare-on9/02_PixelPocker/01_result_test_1.png)
Ta nháº­n Ä‘Æ°á»£c thÃ´ng bÃ¡o `Womp womp...:(`. Rá»“i chÃºng ta sáº½ má»Ÿ chÃºng báº±ng IDA Pro kiáº¿m strings nÃ y náº±m á»Ÿ hÃ m nÃ o?.
![open ida](/src/2022/Flare-on9/02_PixelPocker/02_open_ida.png)
Ta sá»­a Ä‘á»•i láº¡i tÃªn cá»§a má»™t sá»‘ biáº¿n nháº­n diá»‡n rá»“i.
NhÆ° Ä‘Ã£ tháº¥y thÃ¬ ta tháº¥y cÃ³ hÃ m kiá»ƒm tra 2 vá»‹ trÃ­ `x,y` vá»›i má»™t giÃ¡ trá»‹ cÃ³ sáºµn láº¥y dÆ° vá»›i `uX` vÃ  `uY`.
![see var ux](/src/2022/Flare-on9/02_PixelPocker/03_see_var_ux.png)
Ta cáº§n tÃ¬m hiá»ƒu xem biáº¿n `dword_413280` lÃ  gÃ¬? thÃ¬ nÃ³ náº±m trong hÃ m `BitBlt` - 1 hÃ m thá»±c hiá»‡n truyá»n khá»‘i bit dá»¯ liá»‡u tÆ°Æ¡ng á»©ng vá»›i má»™t hÃ¬nh chá»¯ nháº­t pixel tá»« ngá»¯ cáº£nh thiáº¿t bá»‹ nguá»“n Ä‘Ã£ chá»‰ Ä‘á»‹nh sang ngá»¯ cáº£nh thiáº¿t bá»‹ Ä‘Ã­ch.

```C++
BOOL BitBlt(
    [in] HDC   hdc,
    [in] int   x,
    [in] int   y,
    [in] int   cx,
    [in] int   cy,
    [in] HDC   hdcSrc,
    [in] int   x1,
    [in] int   y1,
    [in] DWORD rop
);
```

Do Ä‘Ã³ `dword_413280` lÃ  `cx` - lÃ  chiá»u rá»™ng cá»§a nguá»“n (á»Ÿ trÆ°á»ng há»£p nÃ y lÃ  hÃ¬nh áº£nh); cÃ²n `cy` - lÃ  chiá»u cao cá»§a hÃ¬nh áº£nh.

```text
[in] cx
The width, in logical units, of the source and destination rectangles.

[in] cy
The height, in logical units, of the source and the destination rectangles.
```

![so sanh](/src/2022/Flare-on9/02_PixelPocker/04_so_sanh.png)
BÆ°á»›c so sÃ¡nh á»Ÿ dÃ²ng 43 vÃ  46 kiá»ƒm tra giÃ¡ trá»‹ cá»§a tá»a Ä‘á»™ click chuá»™t theo trá»¥c `(x,y)` thá»a mÃ£n Ä‘iá»u kiá»‡n sau:

x = 0x52414c46 % Ä‘á»™ rá»™ng áº£nh ID 133 = 0x52414c46 % 741 = 95

y = 0x6e4f2d45 % Ä‘á»™ cao áº£nh ID 133 = 0x6e4f2d45 % 641 = 313

NhÆ° váº­y ta click Ä‘Ãºng tá»a Ä‘á»™ trÃªn thÃ¬ sáº½ chuyá»ƒn sang luá»“ng khÃ¡c vÃ  cÃ³ káº¿t quáº£:
![result](/src/2022/Flare-on9/02_PixelPocker/05_result.png)

### 3: Magic_8_Ball (Solved)

Description:

```text
You got a question? Ask the 8 ball!
```

### 4: darn_mice

### 5: t8

### 6: alamode

### 7: anode

### 8: backdoor

### 9: encryptor

### 10: Nur_getraÌˆumt

### 11: the_challenge_that_shall_not_be_named
